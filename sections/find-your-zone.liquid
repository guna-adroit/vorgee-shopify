<style>
    .find-my-goggles{
        position: relative;
    }
    .vorgee-find-goggles-bg-container{
        width: 100%;
        height: 100vh;
        position: relative;
    }
    .vorgee-find-goggles-bg-container img{
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
    .vorgee-find-goggles-bg-container::before {
        content: '';
        display: block;
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0, 0, 0, 0.3);
        z-index: 6;
    }
    .vorgee-find-goggles-form-container{
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0, 0, 0, 0.3);
        z-index: 7;
    }
    .vorgee-find-goggles-form-container label{
        color: white;
        font-size: 30px;
    }
    .vorgee-find-goggles-form-container select{
        font-size: 30px;
        background-color: transparent;
        color: white;
        border: none;
    }
    .vorgee-find-goggles-form-container select option{
        color: black;
        font-size: 16px;
        font-family: 'boxed', sans-serif !important;
        background: white;
    }
    .vorgee-find-goggles-form {
        display: flex;
        flex-direction: column;
        justify-content: center;
        gap: 20px;
        max-width: 100rem;
        margin-left: 4rem;
        margin-right: 4rem;
        height: 100%;
    }
    .find-your-goggles-field{
        display: flex;
        gap: 25px;
        align-items: center;
        background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB3aWR0aD0iMjEyOS43cHgiIGhlaWdodD0iMTAwMHB4IiB2aWV3Qm94PSIwIDAgMjEyOS43IDEwMDAiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDIxMjkuNyAxMDAwOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHN0eWxlIHR5cGU9InRleHQvY3NzIj4uc3Qwe2ZpbGw6I0ZGRkZGRjt9PC9zdHlsZT48Zz48cGF0aCBjbGFzcz0ic3QwIiBkPSJNMTA2NC4yLDEwMDBMNTMuNSwyNDFjLTU5LjEtNDQuNC03MS0xMjguMy0yNi42LTE4Ny40YzQ0LjQtNTkuMSwxMjguMy03MSwxODcuNC0yNi42bDg1MC4xLDYzOC40bDg1MS4yLTYzOC40YzU5LjEtNDQuNCwxNDMtMzIuNCwxODcuNCwyNi44YzQ0LjMsNTkuMSwzMi40LDE0My0yNi44LDE4Ny40TDEwNjQuMiwxMDAweiIvPjwvZz48L3N2Zz4=);
        background-position: center right;
        background-size: 1em;
        background-repeat: no-repeat;
        cursor: pointer;
    }
    .find-your-goggles-field label{
        width: 30%;
        text-align: right;
    }
    .find-your-goggles-field select{
        width: 70%;
        vertical-align: middle;
        font-weight: 600 !important;
        appearance: none;
        background: 0;
        color: #FFF;
        height: auto;
        font-weight: 400;
        padding: .25em 1em .25em 0;
        background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB3aWR0aD0iMTQuNXB4IiBoZWlnaHQ9IjQuOXB4IiB2aWV3Qm94PSIwIDAgMTQuNSA0LjkiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDE0LjUgNC45OyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHN0eWxlIHR5cGU9InRleHQvY3NzIj4uc3Qwe2ZpbGw6I0ZGRkZGRjt9PC9zdHlsZT48Zz48cGF0aCBjbGFzcz0ic3QwIiBkPSJNMCwyLjRDMCwxLjEsMS4xLDAsMi41LDBsMCwwYzEuMywwLDIuNCwxLjEsMi40LDIuNGwwLDBjMCwxLjMtMS4xLDIuNC0yLjQsMi40bDAsMEMxLjEsNC45LDAsMy44LDAsMi40eiIvPjwvZz48L3N2Zz4=);
        background-position: bottom left;
        background-repeat: repeat-x;
    }
    .find-your-goggles-field select:focus{
        outline: none;
    }
    button#goggles-submit {
        max-width: fit-content;
        margin: 0 auto;
        padding: 15px 55px;
        border: none;
        cursor: pointer;
        margin-top: 20px;
    }
    button#goggles-submit:hover{
        background-color: rgb(115, 190, 196);
        color: rgb(255, 255, 255);
    }
    .find-your-zone-results{
        padding-top: 40px;
        padding-bottom: 40px;
    }
    .find-your-zone-result-title{
        text-align: center;
        font-size: 36px;
    }
    .find-your-zone-result-title span{
        font-weight: 300;
    }
    .collection-grid{
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 15px;
    }
    .product-card {
        border: 1px solid #F1F1F1;
        padding: 5px;
    }
    .find-your-zone-result-description{
        font-size: 18px;
        max-width: 960px;
        margin: 0 auto;
        text-align: center;
        margin-bottom: 25px;
    }
    @media screen and (max-width: 768px){
        .find-your-zone-field{
            flex-direction: column;
            gap: 2px;
        }
        .vorgee-find-zone-bg-container{
            height: calc(100vh - 155px);
        }
        .find-your-zone-field label, .find-your-zone-field select{
            width: 100%;
            text-align: left;
            font-size: 16px;
        }
        .vorgee-find-zone-form {
            margin: 0 1.5rem;
        }
        .find-your-zone-result-title{
            font-size: 26px;
        }
        .collection-grid{
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }
        .vorgee-find-zone-form {
            gap: 32px;
        }
        .find-your-zone-result-description{
            font-size: 16px;
        }
    }
</style>


{% comment %} {% paginate shop.metaobjects['find_your_zone'].values by 200 %}
{% comment %}
This block ensures Shopify loads up to 200 entries, so all 125 mappings are available
{% endcomment %}

{% assign zone_mappings = shop.metaobjects['find_your_zone'].values %}

<div id="find-your-zone" class="find-your-zone">
  <div class="vorgee-find-zone-bg-container">
    <img src="https://vorgee.com/wp-content/uploads/2017/01/bubbles.jpg" alt="">
  </div>
  <div class="vorgee-find-zone-form-container section section--page-width">

    <form class="vorgee-find-zone-form">
      <div class="find-your-zone-field">
        <label>I swim </label>
        <select id="frequency" name="frequency">
          <option value="">-- Select --</option>
          <option value="daily">Most days (5+ times a week)</option>
          <option value="regularly">Regularly (3-5 times a week)</option>
          <option value="semi_regularly">Semi-regularly (1-2 times a week)</option>
          <option value="occasionally">When it takes my fancy</option>
          <option value="never">I prefer to bob about, but I like my eyes to be protected</option>
        </select>
      </div>
      <div class="find-your-zone-field">
        <label>I'm immersed in</label>
        <select id="goal" name="goal">
          <option value="">-- Select --</option>
          <option value="race_day_ready">Being race day ready</option>
          <option value="beating_pb">Beating my PB</option>
          <option value="losing_kgs">Losing those last few kilos and/or counteracting the weekend indulgence</option>
          <option value="learn">Growing my water wings (learning to swim)</option>
          <option value="leisure">Enjoying poolside holidays and beach breaks</option>
        </select>
      </div>
      <div class="find-your-zone-field">
        <label>I'm happiest when I am </label>
        <select id="happiest_when" name="happiest_when">
          <option value="">-- Select --</option>
          <option value="diving">Diving off the blocks at the starting pistol</option>
          <option value="in_the_zone">Following the black line</option>
          <option value="progress">Inching towards the horizon</option>
          <option value="learning">In my swim class</option>
          <option value="splashing_about">Splashing about in any body of water</option>
        </select>
      </div>

      <button id="quiz-submit" type="button">Find Your Zone</button>
    </form>

  </div>
</div>

<div id="quiz-collections" class="find-your-zone-results section section--page-width">
  {% for mapping in zone_mappings %}
    <div class="collection-block"
         id="zone-{{ mapping.frequency }}-{{ mapping.immersion }}-{{ mapping.happiness }}"
         style="display:none;">
      {% assign collection = collections[mapping.collection] %}
      {% if collection %}
        <h2 class="find-your-zone-result-title">
          <span>Your zone is</span> {{ collection.title }}
        </h2>
        <p class="find-your-zone-result-description">
          {{ collection.metafields.custom.find_zone_description }}
        </p>
        <div class="collection-grid">
          {% for product in collection.products %}
            <div class="product-card">
              <a href="{{ product.url }}">
                {{ product.featured_image | image_url: width: 400 | image_tag }}
                <h3>{{ product.title }}</h3>
                <p>{{ product.price | money }}</p>
              </a>
            </div>
          {% endfor %}
        </div>
      {% endif %}
    </div>
  {% endfor %}
</div>

{% endpaginate %}

<script>
document.addEventListener("DOMContentLoaded", function() {
  const frequency = document.getElementById("frequency");
  const goal = document.getElementById("goal");
  const happiest = document.getElementById("happiest_when");
  const resultsContainer = document.getElementById("quiz-collections");

  function showCollection() {
    const freqVal = frequency.value;
    const goalVal = goal.value;
    const happyVal = happiest.value;

    // Hide all results first
    resultsContainer.querySelectorAll(".collection-block").forEach(el => {
      el.style.display = "none";
    });

    // Require all 3 selections
    if (!freqVal || !goalVal || !happyVal) return;

    const targetId = `zone-${freqVal}-${goalVal}-${happyVal}`;
    const targetEl = document.getElementById(targetId);

    if (targetEl) {
      targetEl.style.display = "block";
      targetEl.scrollIntoView({ behavior: "smooth" });
    }
  }

  // Run showCollection on button click
  document.getElementById("quiz-submit").addEventListener("click", function(e) {
    e.preventDefault();
    showCollection();
  });

  // Optionally run live on dropdown change
  [frequency, goal, happiest].forEach(select => {
    select.addEventListener("change", showCollection);
  });
});
</script> {% endcomment %}

{% paginate shop.metaobjects['find_my_goggles'].values by 200 %}
{% comment %}
This block ensures Shopify loads up to 200 entries, so all mappings are available
{% endcomment %}

{% assign zone_mappings = shop.metaobjects['find_my_goggles'].values %}

<div id="find-my-goggles" class="find-my-goggles">
  <div class="vorgee-find-goggles-bg-container">
    <img src="https://vorgee.com/wp-content/uploads/2017/01/bubbles.jpg" alt="">
  </div>
  <div class="vorgee-find-goggles-form-container section section--page-width">

    <form class="vorgee-find-goggles-form">
      <div class="find-my-goggles-field">
        <label>What’s your swim zone?</label>
        <select id="swimzone" name="swimzone">
          <option value="">-- Select --</option>
          <option value="Competition">Competition: I need goggles that are built for speed and performance on race days and in training</option>
          <option value="Fitness">Fitness: I need goggles that are built for comfort and endurance in my swim sessions</option>
          <option value="Junior">Junior: I need goggles that are built for my smaller face, without restricting my underwater vision.</option>
        </select>
      </div>
      <div class="find-my-goggles-field">
        <label>What’s your goggles fit preference?</label>
        <select id="fit" name="fit">
          <option value="">-- Select --</option>
          <option value="Snug">Snug: Ideal fit for squad and competitive swimmers</option>
          <option value="Mid">Mid: Firm, but comfortable fit (fitness & junior swimmers)</option>
          <option value="Broad">Broad: Wider lens and broader fit (fitness & junior swimmers)</option>
          <option value="Mask">Mask: Soft, mask-shaped fit (mainly juniors)</option>
        </select>
      </div>
      <div class="find-my-goggles-field">
        <label>You swim the most in:</label>
        <select id="swim_the_most" name="swim_the_most">
          <option value="">-- Select --</option>
          <option value="Indoor pools">Indoor pools</option>
          <option value="Outdoor pools">Outdoor pools</option>
          <option value="Open Waters">Open Waters</option>
          <option value="Any pool or body of water">Any pool or body of water</option>
        </select>
      </div>

      <button id="goggles-submit" type="button">Find My Goggles</button>
    </form>

  </div>
</div>

<div id="goggles-results" class="find-my-goggles-results section section--page-width">
  {% for mapping in zone_mappings %}
    <div class="goggles-block"
         id="zone-{{ mapping.swim_zone }}-{{ mapping.goggles_fit }}-{{ mapping.swim_the_most }}"
         style="display:none;">
      <h2 class="find-my-goggles-result-title">
        <span>Your goggles match:</span>
      </h2>

      <div class="products-grid">
        {% for product in mapping.models.value %}
          <div class="product-card">
            <a href="{{ product.url }}">
              {{ product.featured_image | image_url: width: 400 | image_tag }}
              <h3>{{ product.title }}</h3>
              <p>{{ product.price | money }}</p>
            </a>
          </div>
        {% endfor %}
      </div>
    </div>
  {% endfor %}
</div>

{% endpaginate %}


{% assign entries = shop.metaobjects['find_my_goggles'].values %}

<ul>
  {% for entry in entries %}
    <li>
      <!-- Print metaobject ID -->
      <strong>ID:</strong> {{ entry.swim_zone.value }} <br>

      <!-- Print a field (replace field_name with actual field handle) -->
      <strong>Title:</strong> {{ entry.goggles_fit.value }} <br>

      <!-- If it’s an image field -->
      {% if entry.image_field_name.value != blank %}
        <img src="{{ entry.image_field_name.value | img_url: '300x' }}" alt="">
      {% endif %}
    </li>
  {% endfor %}
</ul>

<script>
document.addEventListener("DOMContentLoaded", function() {
  const swimzone = document.getElementById("swimzone");
  const fit = document.getElementById("fit");
  const swimMost = document.getElementById("swim_the_most");
  const resultsContainer = document.getElementById("goggles-results");

  function showProducts() {
    const swimzoneVal = swimzone.value;
    const fitVal = fit.value;
    const swimMostVal = swimMost.value;

    // Hide all results first
    resultsContainer.querySelectorAll(".goggles-block").forEach(el => {
      el.style.display = "none";
    });

    // Require all 3 selections
    if (!swimzoneVal || !fitVal || !swimMostVal) return;

    const targetId = `zone-${swimzoneVal}-${fitVal}-${swimMostVal}`;
    const targetEl = document.getElementById(targetId);

    if (targetEl) {
      targetEl.style.display = "block";
      targetEl.scrollIntoView({ behavior: "smooth" });
    }
  }

  // Run showProducts on button click
  document.getElementById("goggles-submit").addEventListener("click", function(e) {
    e.preventDefault();
    showProducts();
  });

  // Optionally run live on dropdown change
  [swimzone, fit, swimMost].forEach(select => {
    select.addEventListener("change", showProducts);
  });
});
</script>


{% schema %}
{
  "name": "Find Your Zone",
  "class": "section-wrapper",
  "tag": "section",
  "settings": [],
  
  "presets": [
    {
        "name": "Find Your Zone"
    }
  ]
}
{% endschema %} 